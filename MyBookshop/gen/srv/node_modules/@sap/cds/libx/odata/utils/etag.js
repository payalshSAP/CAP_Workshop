const validateIfNoneMatch = (cdsReq, req, result) => {
  if (cdsReq.target._etag && req.headers['if-none-match'] && result) {
    let header = req.headers['if-none-match']
    if (header.startsWith('W/')) header = header.substring(2)
    if (header.startsWith('"') && header.endsWith('"')) header = header.substring(1, header.length - 1)
    if (header === '*') return true
    if (result[cdsReq.target._etag.name] === header) return true
  }
}

module.exports = {
  validateIfNoneMatch
}
